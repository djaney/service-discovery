version: '3'

services:
  sim_rest:
    build: .
    entrypoint: ./sim.py sim_rest -d sim_user -d sim_videos
    volumes:
      - .:/app
    expose:
      - 80
    environment:
      - FLASK_ENV
    deploy:
      mode: replicated
      replicas: 2

  sim_user:
    build: .
    entrypoint: ./sim.py sim_user
    volumes:
      - .:/app
    expose:
      - 80
    environment:
      - FLASK_ENV
    deploy:
      mode: replicated
      replicas: 2

  sim_videos:
    build: .
    entrypoint: ./sim.py sim_videos -d sim_user
    volumes:
      - .:/app
    expose:
      - 80
    environment:
      - FLASK_ENV
    deploy:
      mode: replicated
      replicas: 2


